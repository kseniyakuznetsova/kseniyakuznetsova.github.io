<html><head><link rel="import" href="../polymer/polymer.html"></head><body><dom-module id="app-media-image-capture"><script>Polymer.AppMedia=Polymer.AppMedia||{},Polymer.AppMedia.MeteringMode={SINGLE_SHOT:'single-shot',CONTINUOUS:'continuous',MANUAL:'manual',NONE:'none'},Polymer.AppMedia.FillLightMode={AUTO:'auto',OFF:'off',FLASH:'flash'},function(){if(null==window.ImageCapture)return void Polymer.Base._warn('Image Capture API is not supported in this browser!');var a=['whiteBalanceMode','colorTemperature','exposureMode','exposureCompensation','iso','focusMode','pointsOfInterest','brightness','contrast','saturation','sharpness','zoom','torch'],b=['fillLightMode','imageHeight','imageWidth'];Polymer({is:'app-media-image-capture',properties:{stream:{type:Object},trackIndex:{type:Number,value:0},videoTrack:{type:Object,notify:!0,computed:'__computeVideoTrack(stream, trackIndex)'},imageCapture:{type:Object,notify:!0,computed:'__computeImageCapture(videoTrack)'},lastPhoto:{type:Object,notify:!0,readOnly:!0},lastFrame:{type:Object,notify:!0,readOnly:!0},photoCapabilities:{type:Object,readOnly:!0,notify:!0},trackCapabilities:{type:Object,notify:!0,computed:'__computeTrackCapabilities(imageCapture, videoTrack)'},photoSettings:{type:Object,readOnly:!0,notify:!0},fillLightMode:{type:String,value:null},imageHeight:{type:Number,value:null},imageWidth:{type:Number,value:null},redEyeReduction:{type:Boolean,value:null},trackConstraints:{type:Object,readOnly:!0,notify:!0},whiteBalanceMode:{type:String,value:null},colorTemperature:{type:Number,value:null},exposureMode:{type:String,value:null},exposureCompensation:{type:Number,value:null},iso:{type:Number,value:null},focusMode:{type:String,value:null},pointsOfInterest:{type:Array,value:null},brightness:{type:Number,value:null},contrast:{type:Number,value:null},saturation:{type:Number,value:null},sharpness:{type:Number,value:null},zoom:{type:Number,value:null},torch:{type:Boolean,value:null}},observers:['__updatePhotoCapabilities(imageCapture, videoTrack)','__updatePhotoSettings(imageCapture, photoCapabilities, fillLightMode, imageHeight, imageWidth, redEyeReduction)','__updateTrackConstraints(imageCapture, trackCapabilities, whiteBalanceMode, exposureMode, focusMode, pointsOfInterest, exposureCompensation, colorTemperature, iso, brightness, contrast, saturation, sharpness, zoom, torch)'],takePhoto:function(){return null==this.imageCapture?Promise.reject(new Error('ImageCapture instance not ready.')):this.imageCapture.takePhoto(this.photoSettings).then(function(a){return this._setLastPhoto(a),a}.bind(this))},grabFrame:function(){return null==this.imageCapture?Promise.reject(new Error('ImageCapture instance not ready.')):this.imageCapture.grabFrame().then(function(a){return this._setLastFrame(a),a}.bind(this))},__computeVideoTrack:function(a,b){return null==a||null==b?void 0:a.getVideoTracks()[b]},__computeImageCapture:function(a){return new ImageCapture(a)},__computeTrackCapabilities:function(a,b){return null==a||null==b?void 0:b.getCapabilities()},__updatePhotoCapabilities:function(){this.debounce('updatePhotoCapabilities',function(){this.imageCapture.getPhotoCapabilities().then(function(a){this._setPhotoCapabilities(a)}.bind(this)).catch(function(a){this.fire('image-capture-capabilities-error',a)}.bind(this))})},__updateTrackConstraints:function(){this.debounce('updateTrackConstraints',function(){var b=this.__generateConfigurationObject(this.trackCapabilities,a);this._setTrackConstraints(b)})},__updatePhotoSettings:function(){this.debounce('updatePhotoSettings',function(){if(null!=this.photoCapabilities){var a=this.__generateConfigurationObject(this.photoCapabilities,b);null!=this.redEyeReduction&&'controllable'===this.photoCapabilities.redEyeReduction&&(a.redEyeReduction=this.redEyeReduction),this._setPhotoSettings(a)}})},__generateConfigurationObject:function(a,b){var c={};if(null!=a)for(var d=0;d<b.length;++d){var e=b[d],f=this[e],g=a[e],h=Array.isArray(g);null==f||null==g||!1===g||h&&-1===g.indexOf(f)||(!h&&g instanceof Object&&(g.min>=f?f=g.min:g.max<=f&&(f=g.max)),c[e]=f)}return c}})}();</script></dom-module></body></html>